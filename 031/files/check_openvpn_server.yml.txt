
PLAY [Check openvpn server] ****************************************************

TASK [Gathering Facts] *********************************************************
ok: [server]

TASK [../roles/check_openvpn_server : Check openvpn server] ********************
changed: [server] => (item=systemctl status openvpn@server.service)
changed: [server] => (item=sudo cat /var/log/openvpn/openvpn.log)
changed: [server] => (item=sudo cat /var/log/openvpn/openvpn-status.log)
changed: [server] => (item=/sbin/ip add show tun0)

TASK [../roles/check_openvpn_server : Store check to files] ********************
changed: [server -> localhost] => (item={'changed': True, 'end': '2021-09-23 22:00:27.355491', 'stdout': '● openvpn@server.service - OpenVPN Robust And Highly Flexible Tunneling Application On server\n   Loaded: loaded (/usr/lib/systemd/system/openvpn@.service; enabled; vendor preset: disabled)\n   Active: active (running) since Чт 2021-09-23 22:00:18 UTC; 9s ago\n Main PID: 30787 (openvpn)\n   Status: "Initialization Sequence Completed"\n   CGroup: /system.slice/system-openvpn.slice/openvpn@server.service\n           └─30787 /usr/sbin/openvpn --cd /etc/openvpn/ --config server.conf', 'cmd': 'systemctl status openvpn@server.service', 'rc': 0, 'start': '2021-09-23 22:00:27.300244', 'stderr': '', 'delta': '0:00:00.055247', 'invocation': {'module_args': {'creates': None, 'executable': None, '_uses_shell': True, 'strip_empty_ends': True, '_raw_params': 'systemctl status openvpn@server.service', 'removes': None, 'argv': None, 'warn': False, 'chdir': None, 'stdin_add_newline': True, 'stdin': None}}, 'stdout_lines': ['● openvpn@server.service - OpenVPN Robust And Highly Flexible Tunneling Application On server', '   Loaded: loaded (/usr/lib/systemd/system/openvpn@.service; enabled; vendor preset: disabled)', '   Active: active (running) since Чт 2021-09-23 22:00:18 UTC; 9s ago', ' Main PID: 30787 (openvpn)', '   Status: "Initialization Sequence Completed"', '   CGroup: /system.slice/system-openvpn.slice/openvpn@server.service', '           └─30787 /usr/sbin/openvpn --cd /etc/openvpn/ --config server.conf'], 'stderr_lines': [], 'failed': False, 'item': 'systemctl status openvpn@server.service', 'ansible_loop_var': 'item'})
changed: [server -> localhost] => (item={'changed': True, 'end': '2021-09-23 22:00:28.046363', 'stdout': "Thu Sep 23 22:00:18 2021 WARNING: file '/etc/openvpn/keys/private/server.key' is group or others accessible\nThu Sep 23 22:00:18 2021 WARNING: file '/etc/openvpn/keys/tc.key' is group or others accessible\nThu Sep 23 22:00:18 2021 OpenVPN 2.4.11 x86_64-redhat-linux-gnu [Fedora EPEL patched] [SSL (OpenSSL)] [LZO] [LZ4] [EPOLL] [PKCS11] [MH/PKTINFO] [AEAD] built on Apr 21 2021\nThu Sep 23 22:00:18 2021 library versions: OpenSSL 1.0.2k-fips  26 Jan 2017, LZO 2.06\nThu Sep 23 22:00:18 2021 Diffie-Hellman initialized with 2048 bit key\nThu Sep 23 22:00:18 2021 Outgoing Control Channel Authentication: Using 160 bit message hash 'SHA1' for HMAC authentication\nThu Sep 23 22:00:18 2021 Incoming Control Channel Authentication: Using 160 bit message hash 'SHA1' for HMAC authentication\nThu Sep 23 22:00:18 2021 ROUTE_GATEWAY 10.0.2.2/255.255.255.0 IFACE=eth0 HWADDR=52:54:00:4d:77:d3\nThu Sep 23 22:00:18 2021 TUN/TAP device tun0 opened\nThu Sep 23 22:00:18 2021 TUN/TAP TX queue length set to 100\nThu Sep 23 22:00:18 2021 /sbin/ip link set dev tun0 up mtu 1500\nThu Sep 23 22:00:18 2021 /sbin/ip addr add dev tun0 local 172.16.10.1 peer 172.16.10.2\nThu Sep 23 22:00:18 2021 /sbin/ip route add 172.16.10.0/24 via 172.16.10.2\nThu Sep 23 22:00:18 2021 Could not determine IPv4/IPv6 protocol. Using AF_INET\nThu Sep 23 22:00:18 2021 Socket Buffers: R=[212992->212992] S=[212992->212992]\nThu Sep 23 22:00:18 2021 UDPv4 link local (bound): [AF_INET]192.168.31.1:1194\nThu Sep 23 22:00:18 2021 UDPv4 link remote: [AF_UNSPEC]\nThu Sep 23 22:00:18 2021 GID set to nobody\nThu Sep 23 22:00:18 2021 UID set to nobody\nThu Sep 23 22:00:18 2021 MULTI: multi_init called, r=256 v=256\nThu Sep 23 22:00:18 2021 IFCONFIG POOL: base=172.16.10.4 size=62, ipv6=0\nThu Sep 23 22:00:18 2021 IFCONFIG POOL LIST\nThu Sep 23 22:00:18 2021 Initialization Sequence Completed", 'cmd': 'sudo cat /var/log/openvpn/openvpn.log', 'rc': 0, 'start': '2021-09-23 22:00:27.981527', 'stderr': '', 'delta': '0:00:00.064836', 'invocation': {'module_args': {'creates': None, 'executable': None, '_uses_shell': True, 'strip_empty_ends': True, '_raw_params': 'sudo cat /var/log/openvpn/openvpn.log', 'removes': None, 'argv': None, 'warn': False, 'chdir': None, 'stdin_add_newline': True, 'stdin': None}}, 'stdout_lines': ["Thu Sep 23 22:00:18 2021 WARNING: file '/etc/openvpn/keys/private/server.key' is group or others accessible", "Thu Sep 23 22:00:18 2021 WARNING: file '/etc/openvpn/keys/tc.key' is group or others accessible", 'Thu Sep 23 22:00:18 2021 OpenVPN 2.4.11 x86_64-redhat-linux-gnu [Fedora EPEL patched] [SSL (OpenSSL)] [LZO] [LZ4] [EPOLL] [PKCS11] [MH/PKTINFO] [AEAD] built on Apr 21 2021', 'Thu Sep 23 22:00:18 2021 library versions: OpenSSL 1.0.2k-fips  26 Jan 2017, LZO 2.06', 'Thu Sep 23 22:00:18 2021 Diffie-Hellman initialized with 2048 bit key', "Thu Sep 23 22:00:18 2021 Outgoing Control Channel Authentication: Using 160 bit message hash 'SHA1' for HMAC authentication", "Thu Sep 23 22:00:18 2021 Incoming Control Channel Authentication: Using 160 bit message hash 'SHA1' for HMAC authentication", 'Thu Sep 23 22:00:18 2021 ROUTE_GATEWAY 10.0.2.2/255.255.255.0 IFACE=eth0 HWADDR=52:54:00:4d:77:d3', 'Thu Sep 23 22:00:18 2021 TUN/TAP device tun0 opened', 'Thu Sep 23 22:00:18 2021 TUN/TAP TX queue length set to 100', 'Thu Sep 23 22:00:18 2021 /sbin/ip link set dev tun0 up mtu 1500', 'Thu Sep 23 22:00:18 2021 /sbin/ip addr add dev tun0 local 172.16.10.1 peer 172.16.10.2', 'Thu Sep 23 22:00:18 2021 /sbin/ip route add 172.16.10.0/24 via 172.16.10.2', 'Thu Sep 23 22:00:18 2021 Could not determine IPv4/IPv6 protocol. Using AF_INET', 'Thu Sep 23 22:00:18 2021 Socket Buffers: R=[212992->212992] S=[212992->212992]', 'Thu Sep 23 22:00:18 2021 UDPv4 link local (bound): [AF_INET]192.168.31.1:1194', 'Thu Sep 23 22:00:18 2021 UDPv4 link remote: [AF_UNSPEC]', 'Thu Sep 23 22:00:18 2021 GID set to nobody', 'Thu Sep 23 22:00:18 2021 UID set to nobody', 'Thu Sep 23 22:00:18 2021 MULTI: multi_init called, r=256 v=256', 'Thu Sep 23 22:00:18 2021 IFCONFIG POOL: base=172.16.10.4 size=62, ipv6=0', 'Thu Sep 23 22:00:18 2021 IFCONFIG POOL LIST', 'Thu Sep 23 22:00:18 2021 Initialization Sequence Completed'], 'stderr_lines': [], 'failed': False, 'item': 'sudo cat /var/log/openvpn/openvpn.log', 'ansible_loop_var': 'item'})
changed: [server -> localhost] => (item={'changed': True, 'end': '2021-09-23 22:00:28.685593', 'stdout': 'OpenVPN CLIENT LIST\nUpdated,Thu Sep 23 22:00:18 2021\nCommon Name,Real Address,Bytes Received,Bytes Sent,Connected Since\nROUTING TABLE\nVirtual Address,Common Name,Real Address,Last Ref\nGLOBAL STATS\nMax bcast/mcast queue length,0\nEND', 'cmd': 'sudo cat /var/log/openvpn/openvpn-status.log', 'rc': 0, 'start': '2021-09-23 22:00:28.641140', 'stderr': '', 'delta': '0:00:00.044453', 'invocation': {'module_args': {'creates': None, 'executable': None, '_uses_shell': True, 'strip_empty_ends': True, '_raw_params': 'sudo cat /var/log/openvpn/openvpn-status.log', 'removes': None, 'argv': None, 'warn': False, 'chdir': None, 'stdin_add_newline': True, 'stdin': None}}, 'stdout_lines': ['OpenVPN CLIENT LIST', 'Updated,Thu Sep 23 22:00:18 2021', 'Common Name,Real Address,Bytes Received,Bytes Sent,Connected Since', 'ROUTING TABLE', 'Virtual Address,Common Name,Real Address,Last Ref', 'GLOBAL STATS', 'Max bcast/mcast queue length,0', 'END'], 'stderr_lines': [], 'failed': False, 'item': 'sudo cat /var/log/openvpn/openvpn-status.log', 'ansible_loop_var': 'item'})
changed: [server -> localhost] => (item={'changed': True, 'end': '2021-09-23 22:00:29.287205', 'stdout': '4: tun0: <POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UNKNOWN group default qlen 100\n    link/none \n    inet 172.16.10.1 peer 172.16.10.2/32 scope global tun0\n       valid_lft forever preferred_lft forever\n    inet6 fe80::bf18:158:d712:2490/64 scope link flags 800 \n       valid_lft forever preferred_lft forever', 'cmd': '/sbin/ip add show tun0', 'rc': 0, 'start': '2021-09-23 22:00:29.274351', 'stderr': '', 'delta': '0:00:00.012854', 'invocation': {'module_args': {'creates': None, 'executable': None, '_uses_shell': True, 'strip_empty_ends': True, '_raw_params': '/sbin/ip add show tun0', 'removes': None, 'argv': None, 'warn': False, 'chdir': None, 'stdin_add_newline': True, 'stdin': None}}, 'stdout_lines': ['4: tun0: <POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UNKNOWN group default qlen 100', '    link/none ', '    inet 172.16.10.1 peer 172.16.10.2/32 scope global tun0', '       valid_lft forever preferred_lft forever', '    inet6 fe80::bf18:158:d712:2490/64 scope link flags 800 ', '       valid_lft forever preferred_lft forever'], 'stderr_lines': [], 'failed': False, 'item': '/sbin/ip add show tun0', 'ansible_loop_var': 'item'})

PLAY RECAP *********************************************************************
server                     : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

