
PLAY [Check openvpn server] ****************************************************

TASK [Gathering Facts] *********************************************************
ok: [server]

TASK [../roles/check_openvpn_server : Check openvpn server] ********************
changed: [server] => (item=systemctl status openvpn@server.service)
changed: [server] => (item=sudo cat /var/log/openvpn/openvpn.log)
changed: [server] => (item=sudo cat /var/log/openvpn/openvpn-status.log)

TASK [../roles/check_openvpn_server : Store check to files] ********************
changed: [server -> localhost] => (item={'changed': True, 'end': '2021-09-18 12:22:36.469584', 'stdout': '● openvpn@server.service - OpenVPN Robust And Highly Flexible Tunneling Application On server\n   Loaded: loaded (/usr/lib/systemd/system/openvpn@.service; disabled; vendor preset: disabled)\n   Active: active (running) since Сб 2021-09-18 12:07:08 UTC; 15min ago\n Main PID: 4180 (openvpn)\n   Status: "Initialization Sequence Completed"\n   CGroup: /system.slice/system-openvpn.slice/openvpn@server.service\n           └─4180 /usr/sbin/openvpn --cd /etc/openvpn/ --config server.conf', 'cmd': 'systemctl status openvpn@server.service', 'rc': 0, 'start': '2021-09-18 12:22:36.445391', 'stderr': '', 'delta': '0:00:00.024193', 'invocation': {'module_args': {'creates': None, 'executable': None, '_uses_shell': True, 'strip_empty_ends': True, '_raw_params': 'systemctl status openvpn@server.service', 'removes': None, 'argv': None, 'warn': False, 'chdir': None, 'stdin_add_newline': True, 'stdin': None}}, 'stdout_lines': ['● openvpn@server.service - OpenVPN Robust And Highly Flexible Tunneling Application On server', '   Loaded: loaded (/usr/lib/systemd/system/openvpn@.service; disabled; vendor preset: disabled)', '   Active: active (running) since Сб 2021-09-18 12:07:08 UTC; 15min ago', ' Main PID: 4180 (openvpn)', '   Status: "Initialization Sequence Completed"', '   CGroup: /system.slice/system-openvpn.slice/openvpn@server.service', '           └─4180 /usr/sbin/openvpn --cd /etc/openvpn/ --config server.conf'], 'stderr_lines': [], 'failed': False, 'item': 'systemctl status openvpn@server.service', 'ansible_loop_var': 'item'})
changed: [server -> localhost] => (item={'changed': True, 'end': '2021-09-18 12:22:37.063886', 'stdout': "Sat Sep 18 11:29:25 2021 WARNING: file '/etc/openvpn/keys/private/server.key' is group or others accessible\nSat Sep 18 11:29:25 2021 WARNING: file '/etc/openvpn/keys/tc.key' is group or others accessible\nSat Sep 18 11:29:25 2021 OpenVPN 2.4.11 x86_64-redhat-linux-gnu [Fedora EPEL patched] [SSL (OpenSSL)] [LZO] [LZ4] [EPOLL] [PKCS11] [MH/PKTINFO] [AEAD] built on Apr 21 2021\nSat Sep 18 11:29:25 2021 library versions: OpenSSL 1.0.2k-fips  26 Jan 2017, LZO 2.06\nSat Sep 18 11:29:25 2021 Diffie-Hellman initialized with 2048 bit key\nSat Sep 18 11:29:25 2021 Outgoing Control Channel Authentication: Using 160 bit message hash 'SHA1' for HMAC authentication\nSat Sep 18 11:29:25 2021 Incoming Control Channel Authentication: Using 160 bit message hash 'SHA1' for HMAC authentication\nSat Sep 18 11:29:25 2021 ROUTE_GATEWAY 10.0.2.2/255.255.255.0 IFACE=eth0 HWADDR=52:54:00:4d:77:d3\nSat Sep 18 11:29:25 2021 TUN/TAP device tun0 opened\nSat Sep 18 11:29:25 2021 TUN/TAP TX queue length set to 100\nSat Sep 18 11:29:25 2021 /sbin/ip link set dev tun0 up mtu 1500\nSat Sep 18 11:29:25 2021 /sbin/ip addr add dev tun0 local 172.16.10.1 peer 172.16.10.2\nSat Sep 18 11:29:25 2021 /sbin/ip route add 172.16.10.0/24 via 172.16.10.2\nSat Sep 18 11:29:25 2021 Could not determine IPv4/IPv6 protocol. Using AF_INET\nSat Sep 18 11:29:25 2021 Socket Buffers: R=[212992->212992] S=[212992->212992]\nSat Sep 18 11:29:25 2021 UDPv4 link local (bound): [AF_INET]192.168.31.1:1194\nSat Sep 18 11:29:25 2021 UDPv4 link remote: [AF_UNSPEC]\nSat Sep 18 11:29:25 2021 GID set to nobody\nSat Sep 18 11:29:25 2021 UID set to nobody\nSat Sep 18 11:29:25 2021 MULTI: multi_init called, r=256 v=256\nSat Sep 18 11:29:25 2021 IFCONFIG POOL: base=172.16.10.4 size=62, ipv6=0\nSat Sep 18 11:29:25 2021 IFCONFIG POOL LIST\nSat Sep 18 11:29:25 2021 Initialization Sequence Completed\nSat Sep 18 12:07:08 2021 event_wait : Interrupted system call (code=4)\nSat Sep 18 12:07:08 2021 /sbin/ip route del 172.16.10.0/24\nRTNETLINK answers: Operation not permitted\nSat Sep 18 12:07:08 2021 ERROR: Linux route delete command failed: external program exited with error status: 2\nSat Sep 18 12:07:08 2021 Closing TUN/TAP interface\nSat Sep 18 12:07:08 2021 /sbin/ip addr del dev tun0 local 172.16.10.1 peer 172.16.10.2\nRTNETLINK answers: Operation not permitted\nSat Sep 18 12:07:08 2021 Linux ip addr del failed: external program exited with error status: 2\nSat Sep 18 12:07:08 2021 SIGTERM[hard,] received, process exiting\nSat Sep 18 12:07:08 2021 WARNING: file '/etc/openvpn/keys/private/server.key' is group or others accessible\nSat Sep 18 12:07:08 2021 WARNING: file '/etc/openvpn/keys/tc.key' is group or others accessible\nSat Sep 18 12:07:08 2021 OpenVPN 2.4.11 x86_64-redhat-linux-gnu [Fedora EPEL patched] [SSL (OpenSSL)] [LZO] [LZ4] [EPOLL] [PKCS11] [MH/PKTINFO] [AEAD] built on Apr 21 2021\nSat Sep 18 12:07:08 2021 library versions: OpenSSL 1.0.2k-fips  26 Jan 2017, LZO 2.06\nSat Sep 18 12:07:08 2021 Diffie-Hellman initialized with 2048 bit key\nSat Sep 18 12:07:08 2021 Outgoing Control Channel Authentication: Using 160 bit message hash 'SHA1' for HMAC authentication\nSat Sep 18 12:07:08 2021 Incoming Control Channel Authentication: Using 160 bit message hash 'SHA1' for HMAC authentication\nSat Sep 18 12:07:08 2021 ROUTE_GATEWAY 10.0.2.2/255.255.255.0 IFACE=eth0 HWADDR=52:54:00:4d:77:d3\nSat Sep 18 12:07:08 2021 TUN/TAP device tun0 opened\nSat Sep 18 12:07:08 2021 TUN/TAP TX queue length set to 100\nSat Sep 18 12:07:08 2021 /sbin/ip link set dev tun0 up mtu 1500\nSat Sep 18 12:07:08 2021 /sbin/ip addr add dev tun0 local 172.16.10.1 peer 172.16.10.2\nSat Sep 18 12:07:08 2021 /sbin/ip route add 172.16.10.0/24 via 172.16.10.2\nSat Sep 18 12:07:08 2021 Could not determine IPv4/IPv6 protocol. Using AF_INET\nSat Sep 18 12:07:08 2021 Socket Buffers: R=[212992->212992] S=[212992->212992]\nSat Sep 18 12:07:08 2021 UDPv4 link local (bound): [AF_INET]192.168.31.1:1194\nSat Sep 18 12:07:08 2021 UDPv4 link remote: [AF_UNSPEC]\nSat Sep 18 12:07:08 2021 GID set to nobody\nSat Sep 18 12:07:08 2021 UID set to nobody\nSat Sep 18 12:07:08 2021 MULTI: multi_init called, r=256 v=256\nSat Sep 18 12:07:08 2021 IFCONFIG POOL: base=172.16.10.4 size=62, ipv6=0\nSat Sep 18 12:07:08 2021 IFCONFIG POOL LIST\nSat Sep 18 12:07:08 2021 Initialization Sequence Completed", 'cmd': 'sudo cat /var/log/openvpn/openvpn.log', 'rc': 0, 'start': '2021-09-18 12:22:37.014517', 'stderr': '', 'delta': '0:00:00.049369', 'invocation': {'module_args': {'creates': None, 'executable': None, '_uses_shell': True, 'strip_empty_ends': True, '_raw_params': 'sudo cat /var/log/openvpn/openvpn.log', 'removes': None, 'argv': None, 'warn': False, 'chdir': None, 'stdin_add_newline': True, 'stdin': None}}, 'stdout_lines': ["Sat Sep 18 11:29:25 2021 WARNING: file '/etc/openvpn/keys/private/server.key' is group or others accessible", "Sat Sep 18 11:29:25 2021 WARNING: file '/etc/openvpn/keys/tc.key' is group or others accessible", 'Sat Sep 18 11:29:25 2021 OpenVPN 2.4.11 x86_64-redhat-linux-gnu [Fedora EPEL patched] [SSL (OpenSSL)] [LZO] [LZ4] [EPOLL] [PKCS11] [MH/PKTINFO] [AEAD] built on Apr 21 2021', 'Sat Sep 18 11:29:25 2021 library versions: OpenSSL 1.0.2k-fips  26 Jan 2017, LZO 2.06', 'Sat Sep 18 11:29:25 2021 Diffie-Hellman initialized with 2048 bit key', "Sat Sep 18 11:29:25 2021 Outgoing Control Channel Authentication: Using 160 bit message hash 'SHA1' for HMAC authentication", "Sat Sep 18 11:29:25 2021 Incoming Control Channel Authentication: Using 160 bit message hash 'SHA1' for HMAC authentication", 'Sat Sep 18 11:29:25 2021 ROUTE_GATEWAY 10.0.2.2/255.255.255.0 IFACE=eth0 HWADDR=52:54:00:4d:77:d3', 'Sat Sep 18 11:29:25 2021 TUN/TAP device tun0 opened', 'Sat Sep 18 11:29:25 2021 TUN/TAP TX queue length set to 100', 'Sat Sep 18 11:29:25 2021 /sbin/ip link set dev tun0 up mtu 1500', 'Sat Sep 18 11:29:25 2021 /sbin/ip addr add dev tun0 local 172.16.10.1 peer 172.16.10.2', 'Sat Sep 18 11:29:25 2021 /sbin/ip route add 172.16.10.0/24 via 172.16.10.2', 'Sat Sep 18 11:29:25 2021 Could not determine IPv4/IPv6 protocol. Using AF_INET', 'Sat Sep 18 11:29:25 2021 Socket Buffers: R=[212992->212992] S=[212992->212992]', 'Sat Sep 18 11:29:25 2021 UDPv4 link local (bound): [AF_INET]192.168.31.1:1194', 'Sat Sep 18 11:29:25 2021 UDPv4 link remote: [AF_UNSPEC]', 'Sat Sep 18 11:29:25 2021 GID set to nobody', 'Sat Sep 18 11:29:25 2021 UID set to nobody', 'Sat Sep 18 11:29:25 2021 MULTI: multi_init called, r=256 v=256', 'Sat Sep 18 11:29:25 2021 IFCONFIG POOL: base=172.16.10.4 size=62, ipv6=0', 'Sat Sep 18 11:29:25 2021 IFCONFIG POOL LIST', 'Sat Sep 18 11:29:25 2021 Initialization Sequence Completed', 'Sat Sep 18 12:07:08 2021 event_wait : Interrupted system call (code=4)', 'Sat Sep 18 12:07:08 2021 /sbin/ip route del 172.16.10.0/24', 'RTNETLINK answers: Operation not permitted', 'Sat Sep 18 12:07:08 2021 ERROR: Linux route delete command failed: external program exited with error status: 2', 'Sat Sep 18 12:07:08 2021 Closing TUN/TAP interface', 'Sat Sep 18 12:07:08 2021 /sbin/ip addr del dev tun0 local 172.16.10.1 peer 172.16.10.2', 'RTNETLINK answers: Operation not permitted', 'Sat Sep 18 12:07:08 2021 Linux ip addr del failed: external program exited with error status: 2', 'Sat Sep 18 12:07:08 2021 SIGTERM[hard,] received, process exiting', "Sat Sep 18 12:07:08 2021 WARNING: file '/etc/openvpn/keys/private/server.key' is group or others accessible", "Sat Sep 18 12:07:08 2021 WARNING: file '/etc/openvpn/keys/tc.key' is group or others accessible", 'Sat Sep 18 12:07:08 2021 OpenVPN 2.4.11 x86_64-redhat-linux-gnu [Fedora EPEL patched] [SSL (OpenSSL)] [LZO] [LZ4] [EPOLL] [PKCS11] [MH/PKTINFO] [AEAD] built on Apr 21 2021', 'Sat Sep 18 12:07:08 2021 library versions: OpenSSL 1.0.2k-fips  26 Jan 2017, LZO 2.06', 'Sat Sep 18 12:07:08 2021 Diffie-Hellman initialized with 2048 bit key', "Sat Sep 18 12:07:08 2021 Outgoing Control Channel Authentication: Using 160 bit message hash 'SHA1' for HMAC authentication", "Sat Sep 18 12:07:08 2021 Incoming Control Channel Authentication: Using 160 bit message hash 'SHA1' for HMAC authentication", 'Sat Sep 18 12:07:08 2021 ROUTE_GATEWAY 10.0.2.2/255.255.255.0 IFACE=eth0 HWADDR=52:54:00:4d:77:d3', 'Sat Sep 18 12:07:08 2021 TUN/TAP device tun0 opened', 'Sat Sep 18 12:07:08 2021 TUN/TAP TX queue length set to 100', 'Sat Sep 18 12:07:08 2021 /sbin/ip link set dev tun0 up mtu 1500', 'Sat Sep 18 12:07:08 2021 /sbin/ip addr add dev tun0 local 172.16.10.1 peer 172.16.10.2', 'Sat Sep 18 12:07:08 2021 /sbin/ip route add 172.16.10.0/24 via 172.16.10.2', 'Sat Sep 18 12:07:08 2021 Could not determine IPv4/IPv6 protocol. Using AF_INET', 'Sat Sep 18 12:07:08 2021 Socket Buffers: R=[212992->212992] S=[212992->212992]', 'Sat Sep 18 12:07:08 2021 UDPv4 link local (bound): [AF_INET]192.168.31.1:1194', 'Sat Sep 18 12:07:08 2021 UDPv4 link remote: [AF_UNSPEC]', 'Sat Sep 18 12:07:08 2021 GID set to nobody', 'Sat Sep 18 12:07:08 2021 UID set to nobody', 'Sat Sep 18 12:07:08 2021 MULTI: multi_init called, r=256 v=256', 'Sat Sep 18 12:07:08 2021 IFCONFIG POOL: base=172.16.10.4 size=62, ipv6=0', 'Sat Sep 18 12:07:08 2021 IFCONFIG POOL LIST', 'Sat Sep 18 12:07:08 2021 Initialization Sequence Completed'], 'stderr_lines': [], 'failed': False, 'item': 'sudo cat /var/log/openvpn/openvpn.log', 'ansible_loop_var': 'item'})
changed: [server -> localhost] => (item={'changed': True, 'end': '2021-09-18 12:22:37.653393', 'stdout': 'OpenVPN CLIENT LIST\nUpdated,Sat Sep 18 12:22:17 2021\nCommon Name,Real Address,Bytes Received,Bytes Sent,Connected Since\nROUTING TABLE\nVirtual Address,Common Name,Real Address,Last Ref\nGLOBAL STATS\nMax bcast/mcast queue length,0\nEND', 'cmd': 'sudo cat /var/log/openvpn/openvpn-status.log', 'rc': 0, 'start': '2021-09-18 12:22:37.604543', 'stderr': '', 'delta': '0:00:00.048850', 'invocation': {'module_args': {'creates': None, 'executable': None, '_uses_shell': True, 'strip_empty_ends': True, '_raw_params': 'sudo cat /var/log/openvpn/openvpn-status.log', 'removes': None, 'argv': None, 'warn': False, 'chdir': None, 'stdin_add_newline': True, 'stdin': None}}, 'stdout_lines': ['OpenVPN CLIENT LIST', 'Updated,Sat Sep 18 12:22:17 2021', 'Common Name,Real Address,Bytes Received,Bytes Sent,Connected Since', 'ROUTING TABLE', 'Virtual Address,Common Name,Real Address,Last Ref', 'GLOBAL STATS', 'Max bcast/mcast queue length,0', 'END'], 'stderr_lines': [], 'failed': False, 'item': 'sudo cat /var/log/openvpn/openvpn-status.log', 'ansible_loop_var': 'item'})

PLAY RECAP *********************************************************************
server                     : ok=3    changed=2    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   

